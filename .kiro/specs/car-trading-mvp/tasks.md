# 车故二手车交易平台 MVP 实现计划

## 实现任务列表

- [ ] 1. 项目初始化与基础配置
  - [ ] 1.1 创建 Vue 3 + TypeScript + Vite 项目
    - 使用 `npm create vite@latest` 创建项目
    - 配置 TypeScript、ESLint、Prettier
    - 安装核心依赖：vue-router、pinia、vant、axios、dayjs
    - _Requirements: 14.1_
  - [ ] 1.2 配置 Vant 组件库和移动端适配
    - 按需引入 Vant 组件
    - 配置 viewport 适配方案
    - 设置全局样式变量
    - _Requirements: 13.1, 13.2, 13.3_
  - [ ] 1.3 创建目录结构和基础文件
    - 创建 api/components/composables/layouts/mock/router/stores/types/utils/views 目录
    - 创建基础类型定义文件
    - _Requirements: 14.1_

- [ ] 2. 类型定义与 Mock 数据
  - [ ] 2.1 定义 TypeScript 类型接口
    - 创建 User、Car、Order、Appointment、Message 等类型定义
    - 创建 API 响应类型和通用类型
    - _Requirements: 14.3_
  - [ ] 2.2 创建 Mock 数据文件
    - 创建品牌车系数据（brands.json）
    - 创建城市数据（cities.json）
    - 创建车源数据（cars.json，50+ 条）
    - 创建用户数据（users.json）
    - _Requirements: 14.1, 14.3_
  - [ ] 2.3 实现 Mock 数据服务层
    - 创建 localStorage 数据持久化工具
    - 实现 Mock API 响应模拟
    - 初始化 Mock 数据加载逻辑
    - _Requirements: 14.1, 14.2, 14.3_
  - [ ]* 2.4 编写属性测试：数据持久化一致性
    - **Property 1: 认证状态一致性**
    - **Validates: Requirements 14.1, 14.2**

- [ ] 3. 路由与布局配置
  - [ ] 3.1 配置 Vue Router 路由
    - 定义所有页面路由
    - 配置路由懒加载
    - _Requirements: 15.1_
  - [ ] 3.2 实现路由守卫
    - 实现认证路由守卫（未登录重定向）
    - 实现卖家权限守卫
    - _Requirements: 1.3_
  - [ ]* 3.3 编写属性测试：路由守卫正确性
    - **Property 15: 路由守卫正确性**
    - **Validates: Requirements 1.3**
  - [ ] 3.4 创建布局组件
    - 创建 DefaultLayout（带底部 TabBar）
    - 创建 SimpleLayout（无底部导航）
    - _Requirements: 13.1_

- [ ] 4. 状态管理实现
  - [ ] 4.1 实现 userStore（用户状态）
    - 用户信息存储和获取
    - 登录状态管理
    - Token 持久化
    - _Requirements: 1.1, 1.2, 1.4, 1.5, 14.1, 14.2_
  - [ ] 4.2 实现 carStore（车源状态）
    - 车源列表缓存
    - 筛选条件管理
    - 收藏状态管理
    - _Requirements: 3.2, 5.1, 5.2_
  - [ ] 4.3 实现 orderStore（订单状态）
    - 订单列表管理
    - 订单状态更新
    - _Requirements: 10.2, 10.4, 11.1_
  - [ ] 4.4 实现 appointmentStore（预约状态）
    - 预约列表管理
    - 预约状态更新
    - _Requirements: 6.2, 6.4_
  - [ ] 4.5 实现 messageStore（消息状态）
    - 消息列表管理
    - 未读消息计数
    - _Requirements: 12.1, 12.2, 12.3_

- [ ] 5. API 服务层实现
  - [ ] 5.1 创建 Axios 实例和拦截器
    - 配置请求拦截器（添加 Token）
    - 配置响应拦截器（错误处理）
    - _Requirements: 1.3, 14.4_
  - [ ] 5.2 实现认证 API（authApi）
    - 发送验证码接口
    - 短信登录接口
    - 获取/更新用户信息接口
    - _Requirements: 1.1, 1.2, 1.4_
  - [ ] 5.3 实现车源 API（carApi）
    - 首页数据接口
    - 车源列表/详情接口
    - 收藏/取消收藏接口
    - 浏览历史接口
    - _Requirements: 2.1, 3.1, 3.2, 4.1, 4.2, 5.1, 5.2, 5.3, 5.4_
  - [ ] 5.4 实现订单 API（orderApi）
    - 创建订单接口
    - 订单列表/详情接口
    - 支付/取消订单接口
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 11.1, 11.2, 11.3, 11.4, 11.5_
  - [ ] 5.5 实现预约 API（appointmentApi）
    - 创建预约接口
    - 预约列表接口
    - 处理预约接口
    - _Requirements: 6.1, 6.2, 6.3, 9.1, 9.2, 9.3, 9.4_
  - [ ] 5.6 实现消息 API（messageApi）
    - 消息列表接口
    - 标记已读接口
    - _Requirements: 12.1, 12.3, 12.5_

- [ ] 6. Checkpoint - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。

- [ ] 7. 公共组件开发
  - [ ] 7.1 实现 CarCard 车源卡片组件
    - 展示车源基本信息
    - 收藏按钮交互
    - 点击跳转详情
    - _Requirements: 3.2, 4.1, 5.1_
  - [ ] 7.2 实现 SearchBar 搜索栏组件
    - 搜索输入框
    - 搜索历史记录
    - 热门搜索词
    - _Requirements: 3.1_
  - [ ] 7.3 实现 FilterPanel 筛选面板组件
    - 多维度筛选条件
    - 排序方式选择
    - 重置和确认按钮
    - _Requirements: 3.2, 3.3, 3.4_
  - [ ] 7.4 实现 ImageUploader 图片上传组件
    - 多图上传
    - 图片压缩
    - 预览和删除
    - _Requirements: 7.3, 15.3_
  - [ ]* 7.5 编写属性测试：图片压缩约束
    - **Property 11: 图片上传约束**
    - **Validates: Requirements 15.3**
  - [ ] 7.6 实现 EmptyState 空状态组件
    - 空数据提示
    - 自定义图标和文案
    - _Requirements: 3.5_

- [ ] 8. 工具函数开发
  - [ ] 8.1 实现筛选和排序工具函数
    - filterCars 筛选函数
    - sortCars 排序函数
    - searchCars 搜索函数
    - _Requirements: 3.1, 3.2, 3.3_
  - [ ]* 8.2 编写属性测试：筛选结果正确性
    - **Property 2: 筛选结果正确性**
    - **Validates: Requirements 3.2**
  - [ ]* 8.3 编写属性测试：排序结果正确性
    - **Property 3: 排序结果正确性**
    - **Validates: Requirements 3.3**
  - [ ]* 8.4 编写属性测试：搜索结果匹配性
    - **Property 4: 搜索结果匹配性**
    - **Validates: Requirements 3.1**
  - [ ] 8.5 实现格式化工具函数
    - 价格格式化
    - 日期格式化
    - 里程格式化
    - _Requirements: 4.2_
  - [ ] 8.6 实现表单验证工具函数
    - 手机号验证
    - 车源表单验证
    - _Requirements: 7.4_
  - [ ]* 8.7 编写属性测试：表单验证完整性
    - **Property 10: 表单验证完整性**
    - **Validates: Requirements 7.4**

- [ ] 9. 认证模块页面
  - [ ] 9.1 实现登录页面
    - 手机号输入
    - 验证码发送和输入
    - 登录按钮和逻辑
    - _Requirements: 1.1, 1.2_
  - [ ] 9.2 实现用户信息编辑页面
    - 头像上传
    - 昵称修改
    - 保存逻辑
    - _Requirements: 1.4_

- [ ] 10. 首页模块
  - [ ] 10.1 实现首页
    - 轮播 Banner
    - 快捷筛选入口
    - 推荐车源列表
    - 下拉刷新和上拉加载
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 11. 车源模块页面
  - [ ] 11.1 实现车源搜索列表页
    - 搜索栏
    - 筛选面板
    - 车源列表
    - 无限滚动加载
    - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_
  - [ ] 11.2 实现车辆详情页
    - 图片轮播和全屏预览
    - 车辆基本信息
    - 配置参数
    - 卖点描述
    - 检测报告
    - 卖家信息
    - 底部操作栏（咨询、预约、支付订金、收藏）
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_
  - [ ] 11.3 实现收藏列表页
    - 收藏车源列表
    - 取消收藏操作
    - _Requirements: 5.3_
  - [ ]* 11.4 编写属性测试：收藏操作一致性
    - **Property 5: 收藏操作一致性**
    - **Validates: Requirements 5.1, 5.2**
  - [ ] 11.5 实现浏览历史页
    - 浏览记录列表
    - 按时间倒序排列
    - _Requirements: 5.4, 5.5_
  - [ ]* 11.6 编写属性测试：浏览历史时序性
    - **Property 6: 浏览历史时序性**
    - **Validates: Requirements 5.5**

- [ ] 12. Checkpoint - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。

- [ ] 13. 预约模块页面
  - [ ] 13.1 实现预约看车弹窗
    - 日期选择
    - 时间段选择
    - 备注输入
    - 提交预约
    - _Requirements: 6.1, 6.2_
  - [ ] 13.2 实现买家预约列表页
    - 预约记录列表
    - 状态筛选
    - 预约详情
    - _Requirements: 6.3_
  - [ ]* 13.3 编写属性测试：预约状态转换合法性
    - **Property 7: 预约状态转换合法性**
    - **Validates: Requirements 6.2, 6.4, 9.2, 9.3, 9.5**

- [ ] 14. 订单模块页面
  - [ ] 14.1 实现订单确认页
    - 车辆信息展示
    - 订金金额
    - 支付方式选择
    - 确认下单
    - _Requirements: 10.1, 10.2_
  - [ ] 14.2 实现支付页面（模拟）
    - 支付二维码展示
    - 模拟支付成功
    - 支付结果页
    - _Requirements: 10.3, 10.4_
  - [ ] 14.3 实现订单列表页
    - 订单列表
    - 状态筛选 Tab
    - 订单卡片
    - _Requirements: 11.1_
  - [ ] 14.4 实现订单详情页
    - 订单信息
    - 车辆信息
    - 支付信息
    - 操作按钮（继续支付、取消订单）
    - _Requirements: 11.2, 11.3, 11.4, 11.5_
  - [ ]* 14.5 编写属性测试：订单状态转换合法性
    - **Property 8: 订单状态转换合法性**
    - **Validates: Requirements 10.4, 11.5**
  - [ ]* 14.6 编写属性测试：订单号唯一性
    - **Property 9: 订单号唯一性**
    - **Validates: Requirements 10.2**

- [ ] 15. 消息模块页面
  - [ ] 15.1 实现消息中心页面
    - 消息列表
    - 未读标记
    - 消息分类
    - 全部已读按钮
    - _Requirements: 12.1, 12.2, 12.3, 12.4, 12.5_
  - [ ]* 15.2 编写属性测试：消息已读状态一致性
    - **Property 12: 消息已读状态一致性**
    - **Validates: Requirements 12.3, 12.5**
  - [ ]* 15.3 编写属性测试：未读消息计数正确性
    - **Property 13: 未读消息计数正确性**
    - **Validates: Requirements 12.2**

- [ ] 16. 用户中心页面
  - [ ] 16.1 实现个人中心页面
    - 用户信息展示
    - 功能入口列表（订单、预约、收藏、浏览历史）
    - 卖家入口（如已认证）
    - 设置和退出登录
    - _Requirements: 1.5_

- [ ] 17. 卖家模块页面
  - [ ] 17.1 实现车源发布页面
    - 品牌车系选择
    - 车辆信息表单
    - 图片上传
    - 表单验证
    - 提交发布
    - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5_
  - [ ] 17.2 实现卖家车源管理页面
    - 车源列表
    - 状态筛选
    - 编辑/上架/下架/标记已售操作
    - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5, 8.6_
  - [ ]* 17.3 编写属性测试：卖家车源归属性
    - **Property 14: 卖家车源归属性**
    - **Validates: Requirements 8.1**
  - [ ] 17.4 实现卖家预约管理页面
    - 预约列表
    - 确认/拒绝/修改时间操作
    - 标记完成
    - _Requirements: 9.1, 9.2, 9.3, 9.4, 9.5_

- [ ] 18. Checkpoint - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。

- [ ] 19. 性能优化与体验提升
  - [ ] 19.1 实现加载状态和骨架屏
    - 列表页骨架屏
    - 详情页骨架屏
    - 按钮加载状态
    - _Requirements: 15.4_
  - [ ] 19.2 实现图片懒加载
    - 列表图片懒加载
    - 详情页图片懒加载
    - _Requirements: 15.2_
  - [ ] 19.3 实现操作反馈
    - Toast 提示
    - 操作确认弹窗
    - 成功/失败状态
    - _Requirements: 15.5_

- [ ] 20. 最终测试与优化
  - [ ] 20.1 完整功能测试
    - 测试所有用户流程
    - 修复发现的问题
    - _Requirements: All_
  - [ ] 20.2 响应式布局调整
    - 移动端适配优化
    - 平板端适配优化
    - _Requirements: 13.1, 13.2, 13.3, 13.4_

- [ ] 21. Final Checkpoint - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。
